function initializeMaps(){setTimeout("initializeMapsDelay();",100)}function initializeMapsDelay(){$.each($(".map-canvas"),function(e){var t=e+1,i=new mapboxgl.Map({container:"map"+t,style:"mapbox://styles/mattkohl/cjzbh31rv0g3c1cpcos3l17xv",center:[-98.5795,39.8283],zoom:3}),a=$(this).find(".sense_id").text(),n=$(this).find(".artist-slug").text(),o=$(this).find(".place-slug").text();function r(e){return $.map(e,function(e,t){if(null!=e&&e.origin)return{type:"Feature",geometry:{type:"Point",coordinates:[e.origin.longitude,e.origin.latitude]},properties:{name:e.origin.name,weight:Math.pow(1.6,e.count)}}})}n?endpoint="/data/artists/"+n+"/":o?endpoint="/data/places/"+o+"/":endpoint="/data/senses/"+a+"/artists/",$.getJSON(endpoint,{csrfmiddlewaretoken:"{{csrf_token}}"},function(e){i.on("load",function(){features=r(n?e.artists:o?e.places:e.senses),i.addSource("points",{type:"geojson",data:{type:"FeatureCollection",features:features}}),i.fitBounds,i.addLayer({id:"points-heat",type:"heatmap",source:"points",maxzoom:9,paint:{"heatmap-weight":["interpolate",["linear"],["get","weight"],0,0,6,3],"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,9,3],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,9,20],"heatmap-opacity":["interpolate",["linear"],["zoom"],7,1,9,0]}}),i.addLayer({id:"points-circles",type:"circle",source:"points",minzoom:7,paint:{"circle-radius":["interpolate",["linear"],["zoom"],7,["interpolate",["linear"],["get","weight"],1,1,6,4],16,["interpolate",["linear"],["get","weight"],1,5,6,50]],"circle-color":["interpolate",["linear"],["get","weight"],1,"rgba(33,102,172,0)",2,"rgb(103,169,207)",3,"rgb(209,229,240)",4,"rgb(253,219,199)",5,"rgb(239,138,98)",6,"rgb(178,24,43)"],"circle-stroke-color":"white","circle-stroke-width":1,"circle-opacity":["interpolate",["linear"],["zoom"],7,0,8,1]}})})})})}mapboxgl.accessToken=mapsToken,initializeMaps();